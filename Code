# Code for "The Burr distribution as a model for the delay between key events in an individualâ€™s infection history"
library("fitdistrplus")
library("pracma")
library("ggplot2")

# cumulative density function (c.d.f) of type III Burr distribution
pburr3 <- function(x,c,k,s){(1+(x/s)^(-c))^(-k)}
# probability density function (p.d.f) of type III Burr distribution
dburr3 <- function(x,c,k,s){(c*k/s)*(x/s)^(-c-1)*(1+(x/s)^(-c))^(-k-1)}
# c.d.f of type X Burr distribution
pburr10 <- function(x,c,k){(1-exp(-(x/c)^(2)))^(k)}
# p.d.f of type X Burr distribution
dburr10 <- function(x,c,k){2*k*x*c^(-2)*exp(-(x/c)^(2))*(1-exp(-(x/c)^(2)))^(k-1)}
# c.d.f of type XII Burr distribution
pburr12 <- function(x,c,k,s){1-(1+(x/s)^(c))^(1-k)}
# p.d.f of type XII Burr distribution
dburr12 <- function(x,c,k,s){c*(k-1)*s^(-1)*(1+(x/s)^(c))^(-k)*(x/s)^(c-1)}
# c.d.f of our derived Burr distribution
pdburr <- function(x,a,b,T){(1+(T/x)^(a*b)*exp(a*(T-x)))^(-1)}
# c.d.f of our derived Burr distribution
ddburr <- function(x,a,b,T){a*(x+b)*(T/x)^(a*b)*exp(a*(T-x))/(x*(1+(T/x)^(a*b)*exp(a*(T-x)))^2)}
# we also provide an alternate derivation of the derived Burr distribution.
# where we use a and b above we use two different parameters which are also coded as a and b (however we can see clearly throughout work that
# the choice of derived Burr distribution formulation will be clear.
# we transform a into a_new = a_old * b_old
# we transform b into b_new = 1/a_old
dburrNEW <- function(x,a,b,T){(x/b+a)*(T/x)^(a)*exp((T-x)/b)/(x*(1+(T/x)^(a)*exp((T-x)/b))^2)}
pburrNEW <- function(x,a,b,T){(1+(T/x)^(a)*exp((T-x)/b))^(-1)}

# incubation period data for legionnaires' disease, anthrax, four groups of salmonellosis data and five groups of campylobacteriosis data
legionnaires <- c(1,1,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,10,10,10,10,11,11,11,12,12,13,15,16)
anthrax <- c(6,6,6,7,8,5,7,7,8,9,4,9,9,6,10,11,12,9,10,10,11,12,10,11,12,13,10,12,13,14,14,14,15,15,15,20,21,21,22,15,17,23,27,29,27,25,34,39,37,42,13,14,34,37,38,41,42,45)
salm1 <- c(7,12,12,14,15,16,16,16,16,17,18,18,18,18,19,20,20,20,20,21,22,27,27,27,29,29,30,30,31,31,34,9,9,13,14,16,16,18,18,20,21,22,23,23,24,24,24,25,25,25,27,27,29,29,34)
salm2 <- c(10,14,16,17,19,19,27,9,9,10,11,11,12,16,16,16,16,16,17,17,17,19,19,20,21,21,22,22,22,22,23,24,33,2,6,7,7,7,8,9,10,10,10,10,11,11,12,13,13,13,13,14,14,15,16,16,17,19,20,20,20,20,21,21,21,21,28,41)
salm3 <- c(3,4,5,5,5,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,12,13,14,14,15,16,19,19,20,21,21,21,21,21,21,22,23,26,27,27,27,28,28,28,29,29,41,6,6,6,6,6,6,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,10,10,10,10,11,11,11,12,13,13,13,13,17,21)
salm4 <- c(3,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,9,10,10,11,11,11,11,11,12,12,14,14,15,15,15,16,16,17,18,19,19,21,21,23,24,25,26,29,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,9,10,11,12)
camp1  <- c(1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,4,4,5,5,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,5,6,6,7,7,8,9,10,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,5,1,1,1,1,1,2,2,2,2,2,2,2,3,3,4,1,1,2,2,4,1,1,1,1,1,1,1,2,2,3,3,3,4,5,6,1,2,2,2,2,3,3,3,3,5,1,1,1,1,1,2,2,2,2,2,3,3,3,3,4,4,4,4,6,6,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,5,5,5,8,4)
camp2 <- c(1,1,2,2,2,2,3,3,3,3,3,4,4,5,6,7,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,5,5,5,5,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,6,6,1,2,2,2,3,3,4,4,5,8,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,9,9,10,10,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,9,9,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,7,7,7,9,9,9,2)
camp3 <- c(2,2,3,3,4,4,5,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5)
camp4 <- c(1,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,9,2,2,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,5,5,5,7,2,2,3,3,3,3,3,3,3,3,3,4,4,4,5,6,7,8,8,10,11,11,1,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,6,6,7,1,1,1,1,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,7,7,7,8,8,8,8)
camp5 <- c(1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,9,14,2,3,3,3,4,5,5,5,5,5,6,1,2,2,2,2,2,2,2,2,2,3,3,3,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,7,8,8,8,8,9,10,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8)

# results for table 2 of analysis of data with standard likelihood methods using fitdist function
library("fitdistrplus")
# each line is model fitting for fitting gamma distribution, types III, X, XII and derived Burr distributions (in that order)
# in the below code, "data" means one of the incubation period datasets in the list above
Model_gamma <- fitdist(data,"gamma",method="mle")
Model_burrIII <- fitdist(data,"burr3",method="mle",start=list(c=1,k=1,s=1))
Model_burrX <- fitdist(data,"burr10",method="mle",start=list(c=1,k=1))
Model_burrXII <- fitdist(data,"burr12",method="mle",start=list(c=2,k=4,s=10))
Model_burrDerived <- fitdist(data,"burrNEW",method="mle",start=list(a=2,b=3,T=6))
# using summary on these outputs "Model_" gives the likelihood, AIC provided in table 2 of the paper
# the likelihood is used for estimating the Bayes factor also obtained in table 2
# the parameter estimates in table 3 are obtained from the summary of these outputs

# now we conduct calculations for the akaike weights and bayes factors analysis in table 2
# ais and log likelihood values from analysis
aic1 <- 549.32
aic2 <- 547.83
aic3 <- 547.62
aic4 <- 548.29
aic5 <- 547.67
aicLN <- 560.55
aicWEI <- 549.67
ll1 <- -272.66
ll2 <- -270.92
ll3 <- -271.81
ll4 <- -271.15
ll5 <- -270.84
llLN <- -278.27
llWEI <- -272.83
# extract minimum aic out of models
min <- min(aic1,aic2,aic3,aic4,aic5,aicLN,aicWEI)
# extract difference of aic from minimum aic
diff1 <- aic1-min
diff2 <- aic2-min
diff3 <- aic3-min
diff4 <- aic4-min
diff5 <- aic5-min
diffLN <- aicLN-min
diffWEI <- aicWEI-min
# calculate akaike weights
w1 <- exp(-0.5*diff1)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
w2 <- exp(-0.5*diff2)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
w3 <- exp(-0.5*diff3)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
w4 <- exp(-0.5*diff4)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
w5 <- exp(-0.5*diff5)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
wLN <- exp(-0.5*diffLN)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
wWEI <-exp(-0.5*diffWEI)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5)+exp(-0.5*diffLN)+exp(-0.5*diffWEI))
# values for analysis in table 2
w1/w1
w2/w1
w3/w1
w4/w1
w5/w1
wLN/w1
wWEI/w1
# more values for analysis in table 2
w2/(w2+w1)
w3/(w3+w1)
w4/(w4+w1)
w5/(w5+w1)
wLN/(wLN+w1)
wWEI/(wWEI+w1)
# more values for analysis in table 2
bf2 <- log10(exp(ll2-ll1))
bf3 <- log10(exp(ll3-ll1))
bf4 <- log10(exp(ll4-ll1))
bf5 <- log10(exp(ll5-ll1))
bfLN <- log10(exp(llLN-ll1))
bfWEI <- log10(exp(llWEI-ll1))

# code for producing figure 2
hist(legionnaires,breaks=seq(0,20,by=1),xlab="Time in Days",ylab="Density",main="Melbourne Data with Model Fits")
lines(seq(0,20,by=0.01),length(legionnaires)*dburr3(seq(0,20,by=0.01),c=5.664,k=0.444,s=7.690),col=2)
lines(seq(0,20,by=0.01),length(legionnaires)*dburr10(seq(0,20,by=0.01),k=1.525,c=6.054),col=3)
lines(seq(0,20,by=0.01),length(legionnaires)*dburr12(seq(0,20,by=0.01),c=2.955,k=4.451,s=10.031),col=4)
lines(seq(0,20,by=0.01),length(legionnaires)*dburrNEW(seq(0,20,by=0.01),a=1.725,b=2.738,T=6.050),col=7)
lines(seq(0,20,by=0.01),length(legionnaires)*dgamma(seq(0,20,by=0.01),shape=4.963,rate=0.785),col=8)
lines(seq(0,20,by=0.01),length(legionnaires)*dlnorm(seq(0,20,by=0.01),meanlog=1.740,sdlog=0.488),col=9)
lines(seq(0,20,by=0.01),length(legionnaires)*dweibull(seq(0,20,by=0.01),shape=2.447,scale=7.129),col=5)
legend(x="topright",legend=c("Type III", "Type X", "Type XII", "Derived", "Gamma", "Lognormal", "Weibull"),lty=c(1,1,1,1,1,1,1),col=c(2,3,4,7,8,9,5),lwd=2)

# code for producing figure of hazards in the appendix
plot(seq(0,20,by=0.01),-log(1-pburr10(seq(0,20,by=0.01),k=1.525,c=6.054)),type="l",col=3,main="Burr Distributions Cumulative Hazard",xlab="Time in Days",ylab="Cumulative Hazard")
lines(seq(0,20,by=0.01),-log(1-pburr3(seq(0,20,by=0.01),c=5.664,k=0.444,s=7.690)),type="l",col=2)
lines(seq(0,20,by=0.01),-log(1-pburr12(seq(0,20,by=0.01),c=2.955,k=4.448,s=10.027)),type="l",col=4)
lines(seq(0,20,by=0.01),-log(1-pburrNEW(seq(0,20,by=0.01),a=1.725,b=2.738,T=6.050)),type="l",col=7)
lines(seq(0,20,by=0.01),-log(1-pgamma(seq(0,20,by=0.01),shape=4.963,rate=0.785)),type="l",col=8)
lines(seq(0,20,by=0.01),-log(1-plnorm(seq(0,20,by=0.01),meanlog=1.740,sdlog=0.488)),type="l",col=9)
lines(seq(0,20,by=0.01),-log(1-pweibull(seq(0,20,by=0.01),shape=2.447,scale=7.129)),type="l",col=5)
legend(x="topleft",legend=c("Type III", "Type X", "Type XII", "Derived", "Gamma", "Lognormal", "Weibull"),lty=c(1,1,1,1,1,1,1),col=c(2,3,4,7,8,9,5),lwd=2)

# code for the DI log-normal model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,exp(-(log(y-x)-a)^2/(2*b^2))/((y-x)*b*(2*pi)^0.5),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,exp(-(log(y-x)-a)^2/(2*b^2))/((y-x)*b*(2*pi)^0.5),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(a,b,legionnaires[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1),hessian=TRUE)
# log-normal parameters
result$par
# log-normal DI log likelihood
result$value
# log-normal DI AIC
result$value*-2+4
# standard errors
hess <- diag(inv(-result$hessian))

# code for the DI weibull model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,(a/b)*((y-x)/b)^(a-1)*exp(-((y-x)/b)^a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,(a/b)*((y-x)/b)^(a-1)*exp(-((y-x)/b)^a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(a,b,legionnaires[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2,b=3),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1),hessian=TRUE)
# weibull parameters
result$par
# weibull DI log likelihood
result$value
# weibull DI AIC
result$value*-2+4
# standard errors
hess <- diag(inv(-result$hessian))

# code for producing DI likelihood on legionnaires' disease dataset
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(a,b,legionnaires[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1),hessian=TRUE)
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4
# standard errors
hess <- diag(inv(-result$hessian))

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(c,k,t,legionnaires[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,100,100),likelihood,control = list(fnscale = -1),hessian=TRUE)
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+4
# standard errors
hess <- diag(inv(-result$hessian))

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(c,k,legionnaires[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(0.2,0.9),upper=c(9,50,50),likelihood,control = list(fnscale = -1),hessian=TRUE)
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4
# standard errors
hess <- diag(inv(-result$hessian))

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(c,k,s,legionnaires[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.9,1),upper=c(9,50,50),likelihood,control = list(fnscale = -1),hessian=TRUE)
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6
# standard errors
hess <- diag(inv(-result$hessian))

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(legionnaires)){
		my.sum=my.sum+fun01(a,b,T,legionnaires[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1.5,b=3,T=5.9),lower=c(0.5,1,1),upper=c(10,10,25),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
# standard errors
hess <- diag(inv(-result$hessian))
# Output for these DI log likelihood fitting provides values given in tables 2

# code for bootstrapping confidence intervals of the mean for each model, for supplementary material

# code for log-normal, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
samp <- rlnorm(n=1000,meanlog=1.740,sdlog=0.488)
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
samp <- rlnorm(n=1000,meanlog=1.531,sdlog=0.576)
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))

# code for weibull, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
samp <- rweibull(n=1000,shape=2.447,scale=7.129)
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
samp <- rweibull(n=1000,shape=2.058,scale=6.003)
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))

# code for gamma, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
samp <- rgamma(n=1000,shape=4.963,rate=0.785)
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
samp <- rgamma(n=1000,shape=3.479,rate=0.653)
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))

# code for Burr III, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburr3(x,c=5.475,k=7.229,s=0.334)-u[i],lower=0,upper=1000)$root)}
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburr3(x,c=5.664,k=7.690,s=0.444)-u[i],lower=0,upper=1000)$root)}
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))


# code for Burr X, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburr10(x,c=6.054,k=1.525)-u[i],lower=0,upper=1000)$root)}
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburr10(x,c=5.848,k=1.065)-u[i],lower=0,upper=1000)$root)}
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))

# Code for Burr XII, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburr12(x,c=2.955,k=4.451,s=10.031)-u[i],lower=0,upper=1000)$root)}
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=10000)
samp <- c()
for (i in 1:10000){
samp <- append(samp,uniroot(function(x) pburr12(x,c=2.249,k=8.643,s=14.194)-u[i],lower=0,upper=1000)$root)}
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))

# Code for derived Burr, means1 is model from using normal data, means2 is model from considering the DI approach
means1 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburrNEW(x,a=1.725,b=2.738,T=6.05)-u[i],lower=0,upper=1000)$root)}
means1 <- append(means1,mean(samp))}
means2 <- c()
for (j in 1:10000){
print(j)
u <- runif(n=1000)
samp <- c()
for (i in 1:1000){
samp <- append(samp,uniroot(function(x) pburrNEW(x,a=0.880,b=2.110,T=5.075)-u[i],lower=0,upper=1000)$root)}
means2 <- append(means2,mean(samp))}
mu_C <- mean(means1)
mu_DI <- mean(means2)
sd_C <- sd(means1)
sd_DI <- sd(means2)
t <- (mu_C-mu_DI)/(sd_C^2/114+sd_DI^2/114)^0.5
df <- (sd_C^2/114+sd_DI^2/114)^2/((sd_C/114)^2/113+(sd_DI/114)^2/113)
p <- 2*(1-pt(abs(t),df))

# code for plotting likelihood fitted models and DI likelihood fitted curve models to legionnaires' data in figure 3
par(mfrow=c(4,2))
x <- seq(0,20,by=0.01)

# Log-normal
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,exp(-(log(y-x)-a)^2/(2*b^2))/((y-x)*b*(2*pi)^0.5),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,exp(-(log(y-x)-a)^2/(2*b^2))/((y-x)*b*(2*pi)^0.5),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(a=1.531,b=0.576,i))
}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Log-normal Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dlnorm(x,meanlog=1.740,sdlog=0.488),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
# Weibull
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,(a/b)*((y-x)/b)^(a-1)*exp(-((y-x)/b)^a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,(a/b)*((y-x)/b)^(a-1)*exp(-((y-x)/b)^a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(a=2.058,b=6.003,i))
}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Weibull Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dweibull(x,shape=2.447,scale=7.129),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(a=3.479,b=0.653,i))}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Gamma Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dgamma(x,shape=4.962,rate=0.785),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(c=4.388,k=0.5,t=6.416,i))}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Burr Type III Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dburr3(x,5.320,0.5,7.448),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(c=5.848319,k=1.064960,i))}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Burr Type X Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dburr10(c=6.054270,k=1.525209,x),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(c=2.249,k=8.643,s=14.194,i))}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Burr Type XII Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dburr12(c=2.955,k=4.448,s=10.027,x),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:20){
values <- append(values,fun01(a=0.880,b=2.110,T=5.075,i))}
y <- seq(0,19)
hist(MelbourneIP,breaks=seq(0,20,by=1),main="Derived Burr Distributed Models",xlab="Time in Days",ylab="Density")
lines(x,length(MelbourneIP)*dburrNEW(a=1.725,b=2.738,T=6.050,x),xlim=c(0,20),col="red")
lines(y,length(MelbourneIP)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')





# we provide the code for obtaining the DI akaike weights and bayes factor analysis in table 2
# ais and log likelihood values from analysis
aic1 <- 552.66
aic2 <- 548.84
aic3 <- 549.18
aic4 <- 550.54
aic5 <- 547.50
ll1 <- -274.33
ll2 <- -271.42
ll3 <- -272.59
ll4 <- -272.27
ll5 <- -270.75
# extract minimum aic out of models
min <- min(aic1,aic2,aic3,aic4,aic5)
# extract difference of aic from minimum aic
diff1 <- aic1-min
diff2 <- aic2-min
diff3 <- aic3-min
diff4 <- aic4-min
diff5 <- aic5-min
# calculate akaike weights
w1 <- exp(-0.5*diff1)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5))
w2 <- exp(-0.5*diff2)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5))
w3 <- exp(-0.5*diff3)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5))
w4 <- exp(-0.5*diff4)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5))
w5 <- exp(-0.5*diff5)/(exp(-0.5*diff1)+exp(-0.5*diff2)+exp(-0.5*diff3)+exp(-0.5*diff4)+exp(-0.5*diff5))
# values for analysis in table 2
w1/w1
w2/w1
w3/w1
w4/w1
w5/w1
# more values for analysis in table 2
w2/(w2+w1)
w3/(w3+w1)
w4/(w4+w1)
w5/(w5+w1)
# more values for analysis in table 2
bf2 <- log10(exp(ll2-ll1))
bf3 <- log10(exp(ll3-ll1))
bf4 <- log10(exp(ll4-ll1))
bf5 <- log10(exp(ll5-ll1))

# for producing the results in table 6 we use the DI likelihood fitting methods coded above with the other disease data, instead of the "MelbourneIP" legionella data
# here we now provide the code to fit the DI likelihood methods to each other disease datasets
# we first analyse anthrax dataset
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(anthrax)){
		my.sum=my.sum+fun01(a,b,anthrax[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(anthrax)){
		my.sum=my.sum+fun01(c,k,t,anthrax[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,100,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(anthrax)){
		my.sum=my.sum+fun01(c,k,anthrax[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(5,0.5),upper=c(25,50,50),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(anthrax)){
		my.sum=my.sum+fun01(c,k,s,anthrax[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.5,1),upper=c(9,50,50),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(anthrax)){
		my.sum=my.sum+fun01(a,b,T,anthrax[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2,b=90,T=11),lower=c(1,1,10),upper=c(5,1000,20),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
# standard errors
hess <- sqrt(diag(inv(-result$hessian)))

# we analyse the first salmonella dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(salm1)){
		my.sum=my.sum+fun01(a,b,salm1[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(salm1)){
		my.sum=my.sum+fun01(c,k,t,salm1[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,100,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(salm1)){
		my.sum=my.sum+fun01(c,k,salm1[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(5,0.5),upper=c(25,50,50),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(salm1)){
		my.sum=my.sum+fun01(c,k,s,salm1[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(3,3,3),upper=c(10,10000,1000),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(salm1)){
		my.sum=my.sum+fun01(a,b,T,salm1[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.5,b=2.5,T=1.1),lower=c(1,1,1),upper=c(7,10,25),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- sqrt(diag(inv(-result$hessian)))

# we analyse the second salmonella dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(salm2)){
		my.sum=my.sum+fun01(a,b,salm2[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(salm2)){
		my.sum=my.sum+fun01(c,k,t,salm2[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,100,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(salm2)){
		my.sum=my.sum+fun01(c,k,salm2[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(5,0.5),upper=c(25,50,50),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(salm2)){
		my.sum=my.sum+fun01(c,k,s,salm2[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.5,1),upper=c(9,100,100),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(salm2)){
		my.sum=my.sum+fun01(a,b,T,salm2[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(1,1,1),upper=c(5,7,20),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- sqrt(diag(inv(-result$hessian)))

# we analyse the third salmonella dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(salm3)){
		my.sum=my.sum+fun01(a,b,salm3[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(salm3)){
		my.sum=my.sum+fun01(c,k,t,salm3[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,100,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(salm3)){
		my.sum=my.sum+fun01(c,k,salm3[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(5,0.5),upper=c(25,50,50),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(salm3)){
		my.sum=my.sum+fun01(c,k,s,salm3[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,5),upper=c(9,75,75),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(salm3)){
		my.sum=my.sum+fun01(a,b,T,salm3[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=100,T=8),lower=c(1,1,1),upper=c(5,Inf,15),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- sqrt(diag(inv(-result$hessian)))

# we analyse the fourth salmonella dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(salm4)){
		my.sum=my.sum+fun01(a,b,salm4[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(salm4)){
		my.sum=my.sum+fun01(c,k,t,salm4[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,500,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(salm4)){
		my.sum=my.sum+fun01(c,k,salm4[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(5,0.5),upper=c(25,50,50),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(salm4)){
		my.sum=my.sum+fun01(c,k,s,salm4[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,2),upper=c(25,75,75),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(salm4)){
		my.sum=my.sum+fun01(a,b,T,salm4[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(1,1,1),upper=c(5,Inf,15),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- sqrt(diag(inv(-result$hessian)))

# we analyse the first campylobacteriosis dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(camp1)){
		my.sum=my.sum+fun01(a,b,camp1[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(camp1)){
		my.sum=my.sum+fun01(c,k,t,camp1[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,500,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(camp1)){
		my.sum=my.sum+fun01(c,k,camp1[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(2,0.4),upper=c(10,10),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(camp1)){
		my.sum=my.sum+fun01(c,k,s,camp1[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,2),upper=c(9,75,75),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(camp1)){
		my.sum=my.sum+fun01(a,b,T,camp1[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(1,1,1),upper=c(5,5,5),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- diag(inv(-result$hessian))

# we analyse the second campylobacteriosis dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(camp2)){
		my.sum=my.sum+fun01(a,b,camp2[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(camp2)){
		my.sum=my.sum+fun01(c,k,t,camp2[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,500,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(camp2)){
		my.sum=my.sum+fun01(c,k,camp2[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(2,0.4),upper=c(10,10),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(camp2)){
		my.sum=my.sum+fun01(c,k,s,camp2[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,2),upper=c(9,75,75),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(camp2)){
		my.sum=my.sum+fun01(a,b,T,camp2[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(1,1,1),upper=c(5,5,5),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- diag(inv(-result$hessian))

# we analyse the third campylobacteriosis dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(camp3)){
		my.sum=my.sum+fun01(a,b,camp3[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(camp3)){
		my.sum=my.sum+fun01(c,k,t,camp3[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,500,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(camp3)){
		my.sum=my.sum+fun01(c,k,camp3[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(2,0.4),upper=c(10,10),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(camp3)){
		my.sum=my.sum+fun01(c,k,s,camp3[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,2),upper=c(9,1500,150),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(camp3)){
		my.sum=my.sum+fun01(a,b,T,camp3[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(1,1,1),upper=c(5,5,5),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- diag(inv(-result$hessian))

# we analyse the fourth campylobacteriosis dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(camp4)){
		my.sum=my.sum+fun01(a,b,camp4[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(camp4)){
		my.sum=my.sum+fun01(c,k,t,camp4[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,500,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(camp4)){
		my.sum=my.sum+fun01(c,k,camp4[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(2,0.4),upper=c(10,10),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(camp4)){
		my.sum=my.sum+fun01(c,k,s,camp4[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,2),upper=c(9,150,150),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(camp4)){
		my.sum=my.sum+fun01(a,b,T,camp4[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(1,1,1),upper=c(10,10,10),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- diag(inv(-result$hessian))

# we analyse the fifth campylobacteriosis dataset
# code for producing DI likelihood
# code for the DI gamma model
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
likelihood <- function(z){
	a <- z[1]
	b <- z[2]
	for (i in 1:length(camp5)){
		my.sum=my.sum+fun01(a,b,camp5[i])
	} 
	return(my.sum)
}
result <- optim(c(a=1,b=1),lower=c(0.1,0.1),upper=c(15,15),likelihood,control = list(fnscale = -1))
# gamma parameters
result$par
# gamma DI log likelihood
result$value
# gamma DI AIC
result$value*-2+4

# code for DI Burr III model
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
likelihood <- function(z){
	c <- z[1]
	k <- z[2]
	t <- z[3]
	for (i in 1:length(camp5)){
		my.sum=my.sum+fun01(c,k,t,camp5[i])
		} 
	return(my.sum)
	}
result <- optim(c(c=11,k=11,t=11),lower=c(0.4,0.1,0.5),upper=c(100,500,100),likelihood,control = list(fnscale = -1))
# Burr III parameters
result$par
# Burr III DI log likelihood
result$value
# Burr III DI AIC
result$value*-2+6

# code for DI Burr X model
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	for (i in 1:length(camp5)){
		my.sum=my.sum+fun01(c,k,camp5[i])
	} 
	return(my.sum)
}
result <- optim(c(c=1,k=1),lower=c(2,0.4),upper=c(10,10),likelihood,control = list(fnscale = -1))
# Burr X parameters
result$par
# Burr X DI log likelihood
result$value
# Burr X DI AIC
result$value*-2+4

# code for DI Burr XII model
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
likelihood <- function(y){
	c <- y[1]
	k <- y[2]
	s <- y[3]
	for (i in 1:length(camp5)){
		my.sum=my.sum+fun01(c,k,s,camp5[i])
	} 
	return(my.sum)
}
result <- optim(c(c=2.1,k=2.5,s=1.1),lower=c(1,1.15,2),upper=c(9,1500,1500),likelihood,control = list(fnscale = -1))
# Burr XII parameters
result$par
# Burr XII DI log likelihood
result$value
# Burr XII DI AIC
result$value*-2+6

# code for derived Burr model
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value)}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){log(integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value)}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
likelihood <- function(y){
	a <- y[1]
	b <- y[2]
	T <- y[3]
	for (i in 1:length(camp5)){
		my.sum=my.sum+fun01(a,b,T,camp5[i])
	} 
	return(my.sum)
}
result <- optim(c(a=2.1,b=2.5,T=1.1),lower=c(0.1,1,1),upper=c(5,5,5),likelihood,control = list(fnscale = -1),hessian=TRUE)
# derived Burr parameters
result$par
# derived Burr DI log likelihood
result$value
# derived Burr DI AIC
result$value*-2+6
hess <- diag(inv(-result$hessian))


# we now want to plot each dataset with curve fits from normal maximum likelihood methods as well as the DI likelihood method plotted on top as was done for the legionella data
# first need to find parameters of distributions when fitting by normal maximum likelihood methods
# find parameters for anthrax dataset
summary(fitdist(anthrax,"gamma",method="mle"))
summary(fitdist(anthrax,"burr3",method="mle",start=list(c=1,k=1,s=1)))
summary(fitdist(anthrax,"burr10",method="mle",start=list(c=5,k=5)))
summary(fitdist(anthrax,"burr12",method="mle",start=list(c=1,k=10,s=1)))
summary(fitdist(anthrax,"burrNEW",method="mle",start=list(a=0.3,b=5,T=1)))
# find parameters for first salmonellosis dataset
summary(fitdist(salm1,"gamma",method="mle"))
summary(fitdist(salm1,"burr3",method="mle",start=list(c=1,k=1,s=1)))
summary(fitdist(salm1,"burr10",method="mle",start=list(c=5,k=5)))
summary(fitdist(salm1,"burr12",method="mle",start=list(c=1,k=10,s=1)))
summary(fitdist(salm1,"burrNEW",method="mle",start=list(a=0.3,b=5,T=10)))
# find parameters for second salmonellosis dataset
fitdist(salm2,"gamma",method="mle")
fitdist(salm2,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(salm2,"burr10",method="mle",start=list(c=5,k=5))
fitdist(salm2,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(salm2,"burrNEW",method="mle",start=list(a=0.3,b=50,T=1))
# find parameters for third salmonellosis dataset
fitdist(salm3,"gamma",method="mle")
fitdist(salm3,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(salm3,"burr10",method="mle",start=list(c=5,k=5))
fitdist(salm3,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(salm3,"dburr",method="mle",start=list(a=0.3,b=100,T=1))
# find parameters for fourth salmonellosis dataset
fitdist(salm4,"gamma",method="mle")
fitdist(salm4,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(salm4,"burr10",method="mle",start=list(c=5,k=5))
fitdist(salm4,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(salm4,"dburr",method="mle",start=list(a=1,b=100,T=10))
# find parameters for first campylobacteriosis dataset
fitdist(camp1,"gamma",method="mle")
fitdist(camp1,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(camp1,"burr10",method="mle",start=list(c=1,k=1))
fitdist(camp1,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(camp1,"burrNEW",method="mle",start=list(a=1,b=1,T=1))
# find parameters for second campylobacteriosis dataset
fitdist(camp2,"gamma",method="mle")
fitdist(camp2,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(camp2,"burr10",method="mle",start=list(c=1,k=1))
fitdist(camp2,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(camp2,"burrNEW",method="mle",start=list(a=1,b=1,T=1))
# find parameters for third campylobacteriosis dataset
fitdist(camp3,"gamma",method="mle")
fitdist(camp3,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(camp3,"burr10",method="mle",start=list(c=1,k=1))
fitdist(camp3,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(camp3,"burrNEW",method="mle",start=list(a=1,b=1,T=1))
# find parameters for fourth campylobacteriosis dataset
fitdist(camp4,"gamma",method="mle")
fitdist(camp4,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(camp4,"burr10",method="mle",start=list(c=1,k=1))
fitdist(camp4,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(camp4,"burrNEW",method="mle",start=list(a=1,b=1,T=1))
# find parameters for fifth campylobacteriosis dataset
fitdist(camp5,"gamma",method="mle")
fitdist(camp5,"burr3",method="mle",start=list(c=1,k=1,s=1))
fitdist(camp5,"burr10",method="mle",start=list(c=1,k=1))
fitdist(camp5,"burr12",method="mle",start=list(c=1,k=10,s=1))
fitdist(camp5,"burrNEW",method="mle",start=list(a=1,b=1,T=1))

# we now produce plots like figure 4, but for the other disease datasets used in analysis
# code for each is provided below

# code for anthrax dataset
par(mfrow=c(3,2))
x <- seq(0,45,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:45){
values <- append(values,fun01(a=2.377,b=0.144,i))}
y <- seq(0,44)
hist(anthrax,breaks=seq(0,45,by=1),main="Anthrax with Gamma Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(anthrax)*dgamma(x,shape=2.716,rate=0.156),xlim=c(0,45),col="red")
lines(y,length(anthrax)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:45){
values <- append(values,fun01(c=2.030,k=2.667,t=6.786,i))}
y <- seq(0,44)
hist(anthrax,breaks=seq(0,45,by=1),main="Anthrax with Burr III Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(anthrax)*dburr3(x,2.088,4.076,5.949),xlim=c(0,45),col="red")
lines(y,length(anthrax)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:45){
values <- append(values,fun01(c=22.497,k=0.712,i))}
y <- seq(0,44)
hist(anthrax,breaks=seq(0,45,by=1),main="Anthrax with Burr X Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(anthrax)*dburr10(c=22.510,k=0.798,x),xlim=c(0,45),col="red")
lines(y,length(anthrax)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:45){
values <- append(values,fun01(c=3.186,k=1.596,s=9.633,i))}
y <- seq(0,44)
hist(anthrax,breaks=seq(0,45,by=1),main="Anthrax with Burr XII Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(anthrax)*dburr12(c=3.886,k=1.479,s=9.753,x),xlim=c(0,45),col="red")
lines(y,length(anthrax)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:45){
values <- append(values,fun01(a=2.352,b=90.001,T=12.963,i))}
y <- seq(0,44)
hist(anthrax,breaks=seq(0,45,by=1),main="Anthrax with Derived Burr Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(anthrax)*dburrNEW(a=2.708,b=691,T=13.981,x),xlim=c(0,45),col="red")
lines(y,length(anthrax)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for first salmonellosis dataset
par(mfrow=c(3,2))
x <- seq(0,34,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:34){
values <- append(values,fun01(a=8.622,b=0.427,i))}
y <- seq(0,33)
hist(salm1,breaks=seq(0,34,by=1),main="Salmonella 1 with Gamma Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm1)*dgamma(x,shape=9.756,rate=0.452),xlim=c(0,34),col="red")
lines(y,length(salm1)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:34){
values <- append(values,fun01(c=10.988,k=0.239,t=27.040,i))}
y <- seq(0,33)
hist(salm1,breaks=seq(0,34,by=1),main="Salmonella 1 with Burr III Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm1)*dburr3(x,10.416,0.276,27.464),xlim=c(0,34),col="red")
lines(y,length(salm1)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:34){
values <- append(values,fun01(c=16.169,k=2.646,i))}
y <- seq(0,33)
hist(salm1,breaks=seq(0,34,by=1),main="Salmonella 1 with Burr X Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm1)*dburr10(c=16.456,k=2.961,x),xlim=c(0,34),col="red")
lines(y,length(salm1)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:34){
values <- append(values,fun01(c=3.505,k=1941.906,s=194.710,i))}
y <- seq(0,33)
hist(salm1,breaks=seq(0,34,by=1),main="Salmonella 1 with Burr XII Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm1)*dburr12(c=3.688,k=99.930,s=81.557,x),xlim=c(0,34),col="red")
lines(y,length(salm1)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:34){
values <- append(values,fun01(a=1.332,b=5.198,T=19.979,i))}
y <- seq(0,33)
hist(salm1,breaks=seq(0,34,by=1),main="Salmonella 1 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm1)*dburrNEW(a=1.446,b=5.265,T=20.982,x),xlim=c(0,34),col="red")
lines(y,length(salm1)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for second salmonellosis dataset
par(mfrow=c(3,2))
x <- seq(0,41,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(a=4.916,b=0.324,i))}
y <- seq(0,40)
hist(salm2,breaks=seq(0,41,by=1),main="Salmonella 2 with Gamma Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm2)*dgamma(x,shape=5.704,rate=0.353),xlim=c(0,34),col="red")
lines(y,length(salm2)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(c=7.071,k=0.319,t=19.929,i))}
y <- seq(0,40)
hist(salm2,breaks=seq(0,41,by=1),main="Salmonella 2 with Burr III Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm2)*dburr3(x,7.149,0.354,20.518),xlim=c(0,41),col="red")
lines(y,length(salm2)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(c=14.533,k=1.512,i))}
y <- seq(0,40)
hist(salm2,breaks=seq(0,41,by=1),main="Salmonella 2 with Burr X Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm2)*dburr10(c=14.713,k=1.760,x),xlim=c(0,41),col="red")
lines(y,length(salm2)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(c=2.943,k=4.896,s=25.290,i))}
y <- seq(0,40)
hist(salm2,breaks=seq(0,41,by=1),main="Salmonella 2 with Burr XII Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm2)*dburr12(c=3.260,k=4.212,s=24.072,x),xlim=c(0,41),col="red")
lines(y,length(salm2)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(a=1.118,b=5.050,T=14.718,i))}
y <- seq(0,40)
hist(salm2,breaks=seq(0,41,by=1),main="Salmonella 2 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm2)*dburrNEW(a=1.552,b=5.707,T=15.682,x),xlim=c(0,40),col="red")
lines(y,length(salm2)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for third salmonellosis dataset
par(mfrow=c(3,2))
x <- seq(0,41,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(a=3.583,b=0.362,i))}
y <- seq(0,40)
hist(salm3,breaks=seq(0,41,by=1),main="Salmonella 3 with Gamma Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm3)*dgamma(x,shape=4.314,rate=0.395),xlim=c(0,34),col="red")
lines(y,length(salm3)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(c=2.858,k=5.042,t=4.095,i))}
y <- seq(0,40)
hist(salm3,breaks=seq(0,41,by=1),main="Salmonella 3 with Burr III Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm3)*dburr3(x,3.190,4.744,5.081),xlim=c(0,41),col="red")
lines(y,length(salm3)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(c=11.923,k=0.961,i))}
y <- seq(0,40)
hist(salm3,breaks=seq(0,41,by=1),main="Salmonella 3 with Burr X Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm3)*dburr10(c=11.976,k=1.167,x),xlim=c(0,41),col="red")
lines(y,length(salm3)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(c=7.501,k=1.297,s=5.794,i))}
y <- seq(0,40)
hist(salm3,breaks=seq(0,41,by=1),main="Salmonella 3 with Burr XII Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm3)*dburr12(c=8.541,k=1.285,s=6.723,x),xlim=c(0,41),col="red")
lines(y,length(salm3)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:41){
values <- append(values,fun01(a=3.681,b=1.6e+5,T=8.100,i))}
y <- seq(0,40)
hist(salm3,breaks=seq(0,41,by=1),main="Salmonella 3 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm3)*dburrNEW(a=4.069,b=494,T=9.140,x),xlim=c(0,40),col="red")
lines(y,length(salm3)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for fourth salmonellosis dataset
par(mfrow=c(3,2))
x <- seq(0,29,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:29){
values <- append(values,fun01(a=3.252,b=0.408,i))}
y <- seq(0,28)
hist(salm4,breaks=seq(0,29,by=1),main="Salmonella 4 with Gamma Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm4)*dgamma(x,shape=4.098,rate=0.456),xlim=c(0,29),col="red")
lines(y,length(salm4)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:29){
values <- append(values,fun01(c=2.500,k=269.307,t=0.573,i))}
y <- seq(0,28)
hist(salm4,breaks=seq(0,29,by=1),main="Salmonella 4 with Burr III Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm4)*dburr3(x,2.867,21.347,2.227),xlim=c(0,29),col="red")
lines(y,length(salm4)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:29){
values <- append(values,fun01(c=10.007,k=0.880,i))}
y <- seq(0,28)
hist(salm4,breaks=seq(0,29,by=1),main="Salmonella 4 with Burr X Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm4)*dburr10(c=10.057,k=1.111,x),xlim=c(0,29),col="red")
lines(y,length(salm4)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:29){
values <- append(values,fun01(c=9.240,k=1.210,s=4.209,i))}
y <- seq(0,28)
hist(salm4,breaks=seq(0,29,by=1),main="Salmonella 4 with Burr XII Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm4)*dburr12(c=10.237,k=1.215,s=5.179,x),xlim=c(0,29),col="red")
lines(y,length(salm4)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:29){
values <- append(values,fun01(a=3.379,b=1.9e+5,T=6.400,i))}
y <- seq(0,28)
hist(salm4,breaks=seq(0,29,by=1),main="Salmonella 4 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density")
lines(x,length(salm4)*dburrNEW(a=3.852,b=1.03e+6,T=7.446,x),xlim=c(0,29),col="red")
lines(y,length(salm4)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for first campylobacteriosis dataset
par(mfrow=c(3,2))
x <- seq(0,10,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(a=1.512,b=0.968,i))}
y <- seq(0,9)
hist(camp1,breaks=seq(0,10,by=1),main="Campylobacter 1 with Gamma Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,120))
lines(x,length(camp1)*dgamma(x,shape=4.048,rate=1.581),xlim=c(0,10),col="red")
lines(y,length(camp1)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(c=3.520,k=0.301,t=2.389,i))}
y <- seq(0,9)
hist(camp1,breaks=seq(0,10,by=1),main="Campylobacter 1 with Burr III Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,120))
lines(x,length(camp1)*dburr3(x,4.019,0.691,2.661),xlim=c(0,10),col="red")
lines(y,length(camp1)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(c=2.775,k=0.434,i))}
y <- seq(0,9)
hist(camp1,breaks=seq(0,10,by=1),main="Campylobacter 1 with Burr X Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,120))
lines(x,length(camp1)*dburr10(c=2.754,k=1.178,x),xlim=c(0,10),col="red")
lines(y,length(camp1)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(c=1.470,k=5.564,s=4.230,i))}
y <- seq(0,9)
hist(camp1,breaks=seq(0,10,by=1),main="Campylobacter 1 with Burr XII Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,120))
lines(x,length(camp1)*dburr12(c=3.042,k=2.541,s=2.784,x),xlim=c(0,10),col="red")
lines(y,length(camp1)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(a=1.097,b=1.616,T=1.259,i))}
y <- seq(0,9)
hist(camp1,breaks=seq(0,10,by=1),main="Campylobacter 1 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,120))
lines(x,length(camp1)*dburrNEW(a=2.850,b=4.099,T=2.305,x),xlim=c(0,10),col="red")
lines(y,length(camp1)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for second campylobacteriosis dataset
par(mfrow=c(3,2))
x <- seq(0,10,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(a=1.843,b=0.853,i))}
y <- seq(0,9)
hist(camp2,breaks=seq(0,10,by=1),main="Campylobacter 2 with Gamma Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,200))
lines(x,length(camp2)*dgamma(x,shape=4.027,rate=1.274),xlim=c(0,10),col="red")
lines(y,length(camp2)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(c=3.328,k=0.398,t=2.895,i))}
y <- seq(0,9)
hist(camp2,breaks=seq(0,10,by=1),main="Campylobacter 2 with Burr III Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,200))
lines(x,length(camp2)*dburr3(x,3.682,0.828,3.041),xlim=c(0,10),col="red")
lines(y,length(camp2)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(c=3.343,k=0.546,i))}
y <- seq(0,9)
hist(camp2,breaks=seq(0,10,by=1),main="Campylobacter 2 with Burr X Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,200))
lines(x,length(camp2)*dburr10(c=3.379,k=1.184,x),xlim=c(0,10),col="red")
lines(y,length(camp2)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(c=1.589,k=5.994,s=5.935,i))}
y <- seq(0,9)
hist(camp2,breaks=seq(0,10,by=1),main="Campylobacter 2 with Burr XII Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,200))
lines(x,length(camp2)*dburr12(c=3.103,k=2.382,s=3.255,x),xlim=c(0,10),col="red")
lines(y,length(camp2)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:10){
values <- append(values,fun01(a=1.345,b=2.313,T=1.793,i))}
y <- seq(0,9)
hist(camp2,breaks=seq(0,10,by=1),main="Campylobacter 2 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,200))
lines(x,length(camp2)*dburrNEW(a=2.883,b=5.517,T=2.829,x),xlim=c(0,10),col="red")
lines(y,length(camp2)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for third campylobacteriosis dataset
par(mfrow=c(3,2))
x <- seq(0,5,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:5){
values <- append(values,fun01(a=6.586,b=2.845,i))}
y <- seq(0,4)
hist(camp3,breaks=seq(0,5,by=1),main="Campylobacter 3 with Gamma Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,60))
lines(x,length(camp3)*dgamma(x,shape=11.342,rate=3.423),xlim=c(0,5),col="red")
lines(y,length(camp3)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:5){
values <- append(values,fun01(c=5.674,k=0.503,t=2.720,i))}
y <- seq(0,4)
hist(camp3,breaks=seq(0,5,by=1),main="Campylobacter 3 with Burr III Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,60))
lines(x,length(camp3)*dburr3(x,5.793,0.912,3.268),xlim=c(0,5),col="red")
lines(y,length(camp3)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:5){
values <- append(values,fun01(c=2.050,k=1.911,i))}
y <- seq(0,4)
hist(camp3,breaks=seq(0,5,by=1),main="Campylobacter 3 with Burr X Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,60))
lines(x,length(camp3)*dburr10(c=2.441,k=3.639,x),xlim=c(0,5),col="red")
lines(y,length(camp3)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:5){
values <- append(values,fun01(c=2.793,k=582.572,s=25.387,i))}
y <- seq(0,4)
hist(camp3,breaks=seq(0,5,by=1),main="Campylobacter 3 with Burr XII Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,60))
lines(x,length(camp3)*dburr12(c=4.069,k=6.228,s=5.319,x),xlim=c(0,5),col="red")
lines(y,length(camp3)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:5){
values <- append(values,fun01(a=2.362,b=1.187,T=2.212,i))}
y <- seq(0,4)
hist(camp3,breaks=seq(0,5,by=1),main="Campylobacter 3 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,60))
lines(x,length(camp3)*dburrNEW(a=3.962,b=1.975,T=3.208,x),xlim=c(0,5),col="red")
lines(y,length(camp3)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for fourth campylobacteriosis dataset
par(mfrow=c(3,2))
x <- seq(0,10,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:11){
values <- append(values,fun01(a=4.099,b=1.335,i))}
y <- seq(0,10)
hist(camp4,breaks=seq(0,11,by=1),main="Campylobacter 4 with Gamma Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,80))
lines(x,length(camp4)*dgamma(x,shape=6.602,rate=1.621),xlim=c(0,11),col="red")
lines(y,length(camp4)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:11){
values <- append(values,fun01(c=4.113,k=0.730,t=3.099,i))}
y <- seq(0,10)
hist(camp4,breaks=seq(0,11,by=1),main="Campylobacter 4 with Burr III Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,80))
lines(x,length(camp4)*dburr3(x,5.106,0.829,3.999),xlim=c(0,11),col="red")
lines(y,length(camp4)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:11){
values <- append(values,fun01(c=3.280,k=1.178,i))}
y <- seq(0,10)
hist(camp4,breaks=seq(0,11,by=1),main="Campylobacter 4 with Burr X Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,80))
lines(x,length(camp4)*dburr10(c=3.555,k=2.028,x),xlim=c(0,11),col="red")
lines(y,length(camp4)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:11){
values <- append(values,fun01(c=3.436,k=2.211,s=2.976,i))}
y <- seq(0,10)
hist(camp4,breaks=seq(0,11,by=1),main="Campylobacter 4 with Burr XII Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,80))
lines(x,length(camp4)*dburr12(c=3.103,k=2.382,s=3.255,x),xlim=c(0,11),col="red")
lines(y,length(camp4)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:11){
values <- append(values,fun01(a=2.930,b=4.144,T=2.773,i))}
y <- seq(0,10)
hist(camp4,breaks=seq(0,11,by=1),main="Campylobacter 4 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,80))
lines(x,length(camp4)*dburrNEW(a=4.108,b=5.976,T=3.801,x),xlim=c(0,11),col="red")
lines(y,length(camp4)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# code for fifth campylobacteriosis dataset
par(mfrow=c(3,2))
x <- seq(0,14,by=0.01)
# Gamma
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.1 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,S,x,y){ifelse(y-x>0,b^(a)*(y-x)^(a-1)*exp(-b*(y-x))/gamma(a),0)}
fun01.2 <- function(a,b,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,S){ifelse(S!=1,fun01.2(a,b,S),fun01.1(a,b,S))}
values <- c()
for (i in 1:14){
values <- append(values,fun01(a=2.165,b=0.647,i))}
y <- seq(0,13)
hist(camp5,breaks=seq(0,14,by=1),main="Campylobacter 5 with Gamma Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,40))
lines(x,length(camp5)*dgamma(x,shape=3.814,rate=0.879),xlim=c(0,14),col="red")
lines(y,length(camp5)*values,type="s",col=7)
# Burr Type III
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.1 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,t,S,x,y){ifelse(y-x>0,c*k*((y-x)/t)^(-c-1)*(1+((y-x)/t)^(-c))^(-k-1)/t,0)}
fun01.2 <- function(c,k,t,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,t,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,t,S){ifelse(S!=1,fun01.2(c,k,t,S),fun01.1(c,k,t,S))}
values <- c()
for (i in 1:14){
values <- append(values,fun01(c=5.683,k=0.208,t=5.549,i))}
y <- seq(0,13)
hist(camp5,breaks=seq(0,14,by=1),main="Campylobacter 5 with Burr III Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,40))
lines(x,length(camp5)*dburr3(x,5.630,0.349,5.800),xlim=c(0,14),col="red")
lines(y,length(camp5)*values,type="s",col=7)
# Burr Type X
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.1 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,S,x,y){ifelse(y-x>0,2*k*(y-x)*c^(-2)*exp(-((y-x)/c)^(2))*(1-exp(-((y-x)/c)^(2)))^(k-1),0)}
fun01.2 <- function(c,k,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,S){ifelse(S!=1,fun01.2(c,k,S),fun01.1(c,k,S))}
values <- c()
for (i in 1:14){
values <- append(values,fun01(c=4.491,k=0.681,i))}
y <- seq(0,13)
hist(camp5,breaks=seq(0,14,by=1),main="Campylobacter 5 with Burr X Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,40))
lines(x,length(camp5)*dburr10(c=4.592,k=1.178,x),xlim=c(0,14),col="red")
lines(y,length(camp5)*values,type="s",col=7)
# Burr Type XII
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.1 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(c,k,s,S,x,y){ifelse(y-x>0,c*(k-1)*(1+((y-x)/s)^(c))^(-k)*((y-x)/s)^(c-1)/s,0)}
fun01.2 <- function(c,k,s,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(c,k,s,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(c,k,s,S){ifelse(S!=1,fun01.2(c,k,s,S),fun01.1(c,k,s,S))}
values <- c()
for (i in 1:14){
values <- append(values,fun01(c=1.614,k=1015.609,s=271.197,i))}
y <- seq(0,13)
hist(camp5,breaks=seq(0,14,by=1),main="Campylobacter 5 with Burr XII Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,40))
lines(x,length(camp5)*dburr12(c=2.414,k=6.654,s=9.502,x),xlim=c(0,14),col="red")
lines(y,length(camp5)*values,type="s",col=7)
# Derived Burr
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.1 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), x, S)$value})},0,1)$value}
my.sum <- 0
fun0 <- function(a,b,T,S,x,y){ifelse(y-x>0,((y-x)/b+a)*exp((T-(y-x))/b+a*log(T/(y-x)))/((y-x)*(1+exp((T-(y-x))/b+a*log(T/(y-x))))^2),0)}
fun01.2 <- function(a,b,T,S){integrate(function(x){sapply(x,function(x){integrate(function(y) fun0(a,b,T,S,x,y), S-1, S)$value})},0,1)$value}
my.sum <- 0
fun01 <- function(a,b,T,S){ifelse(S!=1,fun01.2(a,b,T,S),fun01.1(a,b,T,S))}
values <- c()
for (i in 1:14){
values <- append(values,fun01(a=0.469,b=1.541,T=3.136,i))}
y <- seq(0,13)
hist(camp5,breaks=seq(0,14,by=1),main="Campylobacter 5 with Derived Burr Model Fits",xlab="Time in Days",ylab="Density",ylim=c(0,40))
lines(x,length(camp5)*dburrNEW(a=1.526,b=2.263,T=4.103,x),xlim=c(0,14),col="red")
lines(y,length(camp5)*values,type="s",col=7)
plot.new()
legend("center",legend=c("Original","DI"),col=c("red",7),lwd = 5, xpd = FALSE, horiz = TRUE, cex = 1, seg.len=1, bty = 'n')

# simulation code and code to produce the heatmaps in final figure
shape <- seq(0.5,5,by=0.025)
mean <- seq(1,20,by=0.1)
alpha <- c()
beta <- c()
T <- c()

for (i in shape){
print(i)
for (j in mean){
# print(j)

data <- rgamma(n=1000,shape=i,rate=i/j)
gam <- fitdist(data,"gamma",method="mle")
burr <- fitdist(data,"burrNEW",method="mle",start=list(a=i/j,b=i,T=median(data)))

if (summary(burr)$estim[1]<0 | summary(burr)$estim[2]<0){
fun <- function(a,b,T,x){log(a*(x+b))+(a*b)*log(T/x)+(a*(T-x))-log(x)-2*log(1+(T/x)^(a*b)*exp(a*(T-x)))}
likelihood <- function(z){
my.sum <- 0
a <- z[1]
b <- z[2]
T <- z[3]
for (i in 1:length(data)){
â€‚â€‚â€‚â€‚â€‚â€‚my.sum=my.sum+fun(a,b,T,data[i])
â€‚â€‚â€‚â€‚â€‚â€‚}
return(my.sum)
}
result1 <- optim(c(a=1,b=1,T=1),lower=c(0.01,0.1,0.5*median(data)),upper=c(1,500,1.5*median(data)),likelihood,control = list(fnscale = -1))
alpha <- append(alpha,result1$par[1])
beta <- append(beta,result1$par[1]*result1$par[2])
T <- append(T,result1$par[3])
} else {
alpha <- append(alpha,summary(burr)$estim[1])
beta <- append(beta,summary(burr)$estim[2])
T <- append(T,summary(burr)$estim[3])
}
}
}

data <- expand.grid(X=mean,Y=shape)
data$Z <- T
ggheatmap <- ggplot(data = data, aes(x=X, y=Y, fill=Z)) +
  geom_raster() +
  scale_fill_gradientn(colours=rainbow(5)) +
  geom_hline(yintercept=1,linetype="dotted") +
  scale_x_continuous(limits=c(1,20), expand = c(0, 0)) +
  scale_y_continuous(limits=c(0.5,5), expand = c(0, 0)) +
  theme(axis.text.x = element_text(angle = 0), axis.title.x=element_text(size=20), axis.title.y=element_text(size=20), legend.title=element_text(size=20)) +
  labs(x=expression(mu[Gamma]),y=expression(alpha[Gamma]),fill=expression(T[D])) +
  coord_fixed()
ggheatmap + coord_fixed(ratio=4)


data <- expand.grid(X=mean,Y=shape)
data$Z <- alpha
ggheatmap <- ggplot(data = data, aes(x=X, y=Y, fill=Z)) +
  geom_raster() +
  scale_fill_gradientn(colours=rainbow(5)) +
  geom_hline(yintercept=1,linetype="dotted") +
  scale_x_continuous(limits=c(1,20), expand = c(0, 0)) +
  scale_y_continuous(limits=c(0.5,5), expand = c(0, 0)) +
  theme(axis.text.x = element_text(angle = 0), axis.title.x=element_text(size=20), axis.title.y=element_text(size=20), legend.title=element_text(size=20)) +
  labs(x=expression(mu[Gamma]),y=expression(alpha[Gamma]),fill=expression(alpha[D])) +
  coord_fixed()
ggheatmap + coord_fixed(ratio=4)


data <- expand.grid(X=mean,Y=shape)
data$Z <- beta
ggheatmap <- ggplot(data = data, aes(x=X, y=Y, fill=Z)) +
  geom_raster() +
  scale_fill_gradientn(colours=rainbow(5)) +
  geom_hline(yintercept=1,linetype="dotted") +
  scale_x_continuous(limits=c(1,20), expand = c(0, 0)) +
  scale_y_continuous(limits=c(0.5,5), expand = c(0, 0)) +
  theme(axis.text.x = element_text(angle = 0), axis.title.x=element_text(size=20), axis.title.y=element_text(size=20), legend.title=element_text(size=20)) +
  labs(x=expression(mu[Gamma]),y=expression(alpha[Gamma]),fill=expression(beta[D])) +
  coord_fixed()
ggheatmap + coord_fixed(ratio=4)
